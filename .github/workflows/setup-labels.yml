name: Setup Repository Labels

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths:
      - '.github/workflows/setup-labels.yml'

jobs:
  labels:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      
    steps:
    - name: Create/Update Labels
      uses: actions/github-script@v7
      with:
        script: |
          const labels = [
            { name: 'bug', color: 'd73a4a', description: 'ğŸ› Etwas funktioniert nicht' },
            { name: 'enhancement', color: 'a2eeef', description: 'âœ¨ Neues Feature oder Verbesserung' },
            { name: 'documentation', color: '0075ca', description: 'ğŸ“š Dokumentation verbessern' },
            { name: 'good first issue', color: '7057ff', description: 'ğŸ‘¶ Gut fÃ¼r Einsteiger' },
            { name: 'help wanted', color: '008672', description: 'ğŸ†˜ Hilfe benÃ¶tigt' },
            { name: 'question', color: 'd876e3', description: 'â“ Weitere Informationen benÃ¶tigt' },
            { name: 'wontfix', color: 'ffffff', description: 'ğŸš« Wird nicht behoben' },
            { name: 'duplicate', color: 'cfd3d7', description: 'ğŸ“‹ Duplikat eines anderen Issues' },
            { name: 'invalid', color: 'e4e669', description: 'âš ï¸ UngÃ¼ltiges Issue' },
            { name: 'ruby', color: 'cc342d', description: 'ğŸ’ Ruby Code' },
            { name: 'javascript', color: 'f1e05a', description: 'ğŸŸ¨ JavaScript Code' },
            { name: 'pbs', color: '89e051', description: 'ğŸ“Š PBS Dateien' },
            { name: 'graphics', color: 'ff69b4', description: 'ğŸ¨ Grafiken/Sprites' },
            { name: 'audio', color: '9b59b6', description: 'ğŸµ Audio/Musik' },
            { name: 'translation', color: '3498db', description: 'ğŸŒ Ãœbersetzungen' },
            { name: 'performance', color: 'ff6b6b', description: 'âš¡ Performance-Problem' },
            { name: 'security', color: 'ee0701', description: 'ğŸ”’ Sicherheitsproblem' },
            { name: 'dependencies', color: '0366d6', description: 'ğŸ“¦ Dependencies Update' },
            { name: 'ci/cd', color: '2ecc71', description: 'ğŸ”§ CI/CD Workflows' },
            { name: 'plugin', color: 'f39c12', description: 'ğŸ”Œ Plugin-bezogen' },
            { name: 'battle system', color: 'e67e22', description: 'âš”ï¸ Battle Mechanik' },
            { name: 'ui/ux', color: 'e91e63', description: 'ğŸ¯ User Interface' },
            { name: 'priority: low', color: '00ff00', description: 'ğŸŸ¢ Niedrige PrioritÃ¤t' },
            { name: 'priority: medium', color: 'ffff00', description: 'ğŸŸ¡ Mittlere PrioritÃ¤t' },
            { name: 'priority: high', color: 'ff0000', description: 'ğŸ”´ Hohe PrioritÃ¤t' },
          ];
          
          for (const label of labels) {
            try {
              await github.rest.issues.createLabel({
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: label.name,
                color: label.color,
                description: label.description
              });
              console.log(`âœ… Created label: ${label.name}`);
            } catch (error) {
              if (error.status === 422) {
                await github.rest.issues.updateLabel({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  name: label.name,
                  color: label.color,
                  description: label.description
                });
                console.log(`ğŸ“ Updated label: ${label.name}`);
              } else {
                console.log(`âŒ Error with label ${label.name}: ${error.message}`);
              }
            }
          }
